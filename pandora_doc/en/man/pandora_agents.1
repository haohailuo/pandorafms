Pandora(Agents)                                                Pandora(Agents)



NNAAMMEE
       pandora_agents - Agents for PandoraFMS


AAVVAAIILLAABBIILLIITTYY
       Linux, AIX, Solaris, Windows...


DDEESSCCRRIIPPTTIIOONN
       This is the man page for Linux Pandora Agents.

       Pandora  FMS  agents  collect  all system’s data. They are executed in
       each local system, although they can also collect remote information by
       installing  monitoring  systems  for  the  agent  in  several different
       machines - called satellite agents

       They are developed to work under a given platform, making  use  of  the
       speci ﬁc  tools of the language being used: VBSCript/Windows Scripting
       for Microsoft platforms (Win2000, WinXP y Win2003), ShellScripting  for
       UNIX  -  which  includes Linux, Solaris, AIX, HP-UX and BSD, as well as
       the Nokia’s IPSO. Pandora agents can be  developed  in  virtually  any
       language,  given its simple API system and being open source. There are
       branches of the Pandora project started for the creation of  agents  in
       Posix C, Perl and Java for those systems requiring closed agents.

       Pandora Agents are Free Software, i.e., the way agents collect and sent
       information is documented. An agent can be recreated in any programming
       language, and can be upgraded easily, to improve aspects of the program
       not covered so far.

       This man describes the installation of agents in machines running  over
       Linux operating systems.


SSYYPPNNOOSSIISS
       GGeenneerriicc rroollee ooff tthhee aaggeennttss

       Regardless  the  platform an agent is running on, this is formed of the
       following elements: A script (or binary application  in  Windows)  that
       collects and sends the data to the server. For UNIX machines the script
       is called pandora_agent.sh and is executed directly  from  the  Pandora
       agent folder.

       One  or  several configuration ﬁfiles where the values to be collected
       are deﬁned. The ﬁle is called pandora_agent.conf both for Windows and
       Unix machines.

       This  simple  structure  makes  it  easy the customisation of an agent.
       There is no need to code again the agent to modify the way it works, as
       the conﬁguration ﬁle holds most of the parameters needed to do so.

       MMaaiinn SSccrriipptt

       The main script is the executable ﬁle that collects the data speciﬁed
       in the conﬁguration ﬁle. It sends the data to the server in  XML.  In
       Windows  machines application is installed as a service and is executed
       at the time intervals set in the configuration ﬁfile. In machines run-
       ning  over  UNIX the main script is run through a special script called
       pandora_agent_daemon, and runs continuously in the machine  as  a  pro-
       cess.

       CCoonnffiigguurraattiioonn FFiillee

       The  data collection in the host system is the gathering of independent
       data units, which are deﬁned in the  pandora_agent.conf   ﬁfile.  The
       pandora_agent.conf file is divided in two parts:

       _G_e_n_e_r_a_l _p_a_r_a_m_e_t_e_r_s

        Configure general options about server location, agent name, interval,
       and other general options.

       _M_o_d_u_l_e _d_e_f_i_n_i_t_i_o_n_s

       Configure and defined the method of extraction for each piece of infor-
       mation  that  will  be  extracted  from  local host and sent to Pandora
       Server.

       GGeenneerraall ppaarraammeetteerrss

       The general parameters of the agent conﬁguration are deﬁned  in  this
       section. Some of these parameters are common for all systems and others
       speciﬁc for Windows or UNIX. The general parameters are: _s_e_r_v_e_r___p_a_t_h_:

       The server path is the full path of the folder where the server  stores
       the  data  sent  by  the  agent.  It  is usually: /opt/pandora/data_in.
       _s_e_r_v_e_r___i_p_:

       The server IP is the IP address or the host name of the Pandora server,
       where  the  data will be stored. The host must be reachable and must be
       listening to port 22 (SSH).

       _t_e_m_p_o_r_a_l_:

        This is the full path of the folder where the agent  stores  the  data
       locally, before it is sent to the server. It must be said that the data
       packages are deleted once the agent tries to contact Pandora server, no
       matter  if  the  communication  was  successful or not. This is done to
       avoid over ﬂcoding hard drive of the host system where the agent runs.
       The  location  of  the local folder varies with the architecture of the
       host system. In Unix systems this is usually /opt/pandora/data_out

       _i_n_t_e_r_v_a_l_:

       This is the time interval in seconds in which the  agent  will  collect
       data from the host system and send the data packages to the server. The
       recommended value ranges from 300 (5 minutes) to 600 (10 minutes). This
       number could be larger, although it is important to consider the impact
       of a larger number on the database.

       _d_e_b_u_g_:

       This parameter is used to test the generation of data ﬁfiles,  forcing
       the  agent  to  do  not copy data file to server, so you can check data
       ﬁfile contents and copy XML data ﬁfile manually. It does  not  delete
       any  data  when the process is ﬁnished, so data ﬁfile will be in temp
       directory. The activity is written in a log ﬁfile. The ﬁfile is named
       pandora_agent.log.  This  log ﬁfile can be used to test the system and
       to investigate potential issues.

       _a_g_e_n_t___n_a_m_e_:

       This is an alternative host name. This parameter is optional as  if  it
       is not declared the name is obtained directly from the system.

       _c_h_e_c_k_s_u_m_:

       This  parameter  can  take two values. If the value is 1, the checksums
       are performed through MD5. If the value is 0, the checksum is not  per-
       formed  at  all. This may be useful for systems where a MD5 tool cannot
       be implemented. If the checksum is deactivated in the agent it must  be
       also disconnected in the server. Otherwise it could create problems.

       An  example  of  the general parameters from a Unix conﬁguration would
       be.

       _s_e_r_v_e_r___i_p _P_a_n_d_o_r_a___S_e_r_v_e_r
       _s_e_r_v_e_r___p_a_t_h _/_o_p_t_/_p_a_n_d_o_r_a_/_d_a_t_a___i_n
       _t_e_m_p_o_r_a_l _/_o_p_t_/_p_a_n_d_o_r_a_/_d_a_t_a___o_u_t
       _i_n_t_e_r_v_a_l _3_0_0
       _a_g_e_n_t___n_a_m_e _s_a_t_e_l_l_i_t_e___a_g_e_n_t
       _d_e_b_u_g _1
       _c_h_e_c_k_s_u_m _1

       MMoodduullee ddeeffiinniittiioonn

       Each data item that is to be collected must  be  defined  precisely  in
       each  module,  using the exact syntax.  As many values as necessary can
       be set to be collected, adding at the end of the general parameters  as
       many modules as the number of values to collect. Each module is made of
       several directives. Following is a descriptive relation of  all  module
       marks available for Unix agents.

       _m_o_d_u_l_e___b_e_g_i_n

       Defines the beginning of the module.

       _m_o_d_u_l_e___n_a_m_e _n_a_m_e

       Name of the module. This is the id for this module, choose a name with-
       out blank spaces and not very long. There is  no  practical  limitation
       (max of 250 chars) but will be easier to manage if you use short names.
       This name CANNOT be duplicated with a similar name in the  same  agent.
       This name could be duplicated with other modules in other agents.

       _m_o_d_u_l_e___t_y_p_e _t_y_p_e

       Data type the module will handle. There are four data types for agents:



       Numeric (generic_data).

              Simple numeric data, ﬂfloat or integer. If the  values  are  of
              the ﬂoat type, they will be truncated to their integer value.


       Incremental (generic_date_inc).

              Integer  numeric  data  equal  to  the  differential between the
              actual value and the previous one.  When  this  differential  is
              negative  the value is set to 0.  Alphanumeric (generic_string).
              Text strings up to 255 characters.


       Monitors (generic_proc).

              Stores numerically the status of the processes. This  data  type
              is  called monitor because it assigns 0 to an "Incorrect" status
              and any value above 0 to any "Correct" status.


       _m_o_d_u_l_e___e_x_e_c _c_o_m_m_a_n_d

       This is the generic "command to execute" directive. Both, for Unix  and
       Windows  agents there is only one directive to obtain data in a generic
       way, executing a single command (you could use  pipes  for  redirecting
       execution  to  anoter  command).  This directive executes a command and
       stores the returned value. This method is  also  available  on  Windows
       agents. This is the "general purpose method" for both kind of agents.

       _m_o_d_u_l_e___m_i_n _v_a_l_u_e

       This  is the minimum valid value for the data generated in this module.
       If the module has not yet been deﬁned in the web  console  this  value
       will be taken from this directive. This directive is not compulsory.

       This value does not override the value deﬁned in the agent if the mod-
       ule does not exist in the management console. It is  created  automati-
       cally when working on learning mode.

       _m_o_d_u_l_e___m_a_x _v_a_l_u_e

       It is the maximum valid value for the data generated in this module. If
       the module has not been deﬁned in the web console this value  will  be
       taken  from this directive. This directive is not compulsory and is not
       supported by the Windows agent. This value does not override the  value
       de ﬁned  in  the  agent if the module does not exist in the management
       console. This is created automatically when working on learning mode.

       _m_o_d_u_l_e___d_e_s_c_r_i_p_t_i_o_n _t_e_x_t

       This directive is used to add a comment to the module.  This  directive
       is  not  compulsory.  This value does not override the value deﬁned in
       the agent if the module does not exist in the management console.  This
       is created automatically when working on learning mode.

       _m_o_d_u_l_e___i_n_t_e_r_v_a_l _f_a_c_t_o_r

       Pandora  1.2  introduces  this  new  feature. You can, for each module,
       setup its own interval. This interval its calculated as a multiply fac-
       tor  for agent interval. For example, if your agent has interval 300 (5
       minutes), and you want a module only be calculated each 15 minutes, you
       could  add  this line: module_interval 3. So this module will be calcu-
       lated each 300sec x 3 = 900sec (15 minutes).

       _m_o_d_u_l_e___e_n_d

       Ends module definition

       AAggeenntt ttyyppeess

       It is possible to monitor virtually any system with Pandora.  This  can
       be  done  either  with  a local agent collecting data directly from the
       system to be monitored, using a a satellite agent collecting data  from
       a  system  by  SNMP  or  using  the  new Pandora 1.2 agents, the remote
       agents, who can chack using remote network polling (TCP, UCP, ICMP/PING
       and SNMP) remote services, from the Pandora Network Server.

       The  local  agents  can be either Windows or Unix agents. The satellite
       agents can be implemented using any of the agents  above.  The  modules
       are  con ﬁgured to collect data from the external system by, for exam-
       ple, an SNMPGET tool.

       UUNNIIXX aaggeennttss

       _I_n_t_r_o_d_u_c_t_i_o_n _t_o _U_n_i_x _a_g_e_n_t_s

       The in-built UNIX applications and tools make  the  agents  running  on
       this  system  be  very simple. There are also agents developed for AIX,
       Linux, Solaris and BSD platforms, some of them  very  similar  but  not
       identical.  Requirements for the installation of Pandora Agents on UNIX
       _A_I_X

       MD5 signatures are used to guarantee the  integrity  of  the  generated
       data  packages.  The  MD5  package  is integrated in AIX 5.1 and above.
       There is a freeware package for AIX 4.3 but it has several  issues  and
       might  not  work correctly. In the case of having problems with the AIX
       agents the checksum system used to validate the integrity of  the  data
       can be disabled.

       _S_o_l_a_r_i_s

       The  MD5  package  is necessary to execute the Solaris agent correctly.
       This package is available from http://sunfreeware.com . It can be  also
       downloaded for Solaris 8 from the following URL:

       ftp://ftp.sunfreeware.com/pub/freeware/sparc/8/md5-6142000-sol8-sparc-
       local.gz MD5 Package installation on Solaris

       _r_o_o_t_@_s_t_e_s_t_:_/_t_m_p_:_> _g_z_i_p _-_d _m_d_5_-_6_1_4_2_0_0_0_-_s_o_l_8_-_s_p_a_r_c_-_l_o_c_a_l_._g_z
       _r_o_o_t_@_s_t_e_s_t_:_/_t_m_p_:_> _p_k_g_a_d_d _-_d _._/_m_d_5_-_6_1_4_2_0_0_0_-_s_o_l_8_-_s_p_a_r_c_-_l_o_c_a_l
       _T_h_e _f_o_l_l_o_w_i_n_g _p_a_c_k_a_g_e_s _a_r_e _a_v_a_i_l_a_b_l_e_:
       _1 _S_M_C_m_d_5 _m_d_5
       _(_s_p_a_r_c_) _6_1_4_2_0_0_0
       _S_e_l_e_c_t _p_a_c_k_a_g_e_(_s_) _y_o_u _w_i_s_h _t_o _p_r_o_c_e_s_s _(_o_r ’_a_l_l’ _t_o _p_r_o_c_e_s_s
       _a_l_l _p_a_c_k_a_g_e_s_)_. _(_d_e_f_a_u_l_t_: _a_l_l_) _[_?_,_?_?_,_q_]_: _1
       _S_o_l_a_r_i_s _S_S_H

       The suggested SSH client is OpenSSH. If any other SSH client is  to  be
       used  it must be considered that each piece software may have different
       ways to generate or manage keys. For example, if F-Secure SSH is  used,
       the  public  key must be in OpenSSH format when the keys are generated.
       The format can be changed from IETF to OpenSSH with F-Secure SSH, using
       the following command:

       _s_s_h_-_k_e_y_g_e_n _-_i _-_f _f_i_l_e___i_e_t_f___p_u_b_k_e_y

       GGNNUU//LLiinnuuxx

       SSH  and  MD5  should be installed in Linux by default, but if they are
       not they can be installed using the tools available in  each  distribu-
       tion.

       BBSSDD ((IIPPSSOO))

       SSH and MD5 should be installed by default. If they are not, it is nec-
       essary to install them.

       PPaannddoorraa UUnniixx AAggeenntt iinnssttaallll

       The software comes in a .tar.gz ﬁle. First of all the ﬁfile needs  to
       be  extracted  into  a folder, usually /opt/pandora_agent, although any
       other folder may be used. If a different folder  is  used,  the  daemon
       launcher must be modified by changing route to $PANDORA_HOME.

       There is hardly any difference between AIX, Solaris and Linux, and they
       all work around the hash MD5 generation binaries.

       This is the structure of the installation in  /opt/pandora_agent/  once
       the ﬁfiles have been extracted:

       _/_o_p_t_/_p_a_n_d_o_r_a___a_g_e_n_t_/_d_a_t_a___o_u_t

       Folder where the data collected by the agents is stored.

       _/_o_p_t_/_p_a_n_d_o_r_a___a_g_e_n_t_/_d_o_c

       Folder with information about the agent and its license.

       _/_o_p_t_/_p_a_n_d_o_r_a___a_g_e_n_t_/_p_a_n_d_o_r_a___a_g_e_n_t_._c_o_n_f

       File  where the data to be collected is deﬁned, along side the command
       to be executed for the data collection. This is the system core, as  it
       deﬁnes the main data to be collected in any Firewall.

       _/_o_p_t_/_p_a_n_d_o_r_a___a_g_e_n_t_/_p_a_n_d_o_r_a___u_s_e_r_._c_o_n_fﬁ

       File where several of the parameters to collect data from the monitored
       system are defined in more detail.

       _/_o_p_t_/_p_a_n_d_o_r_a___a_g_e_n_t_/_p_a_n_d_o_r_a___a_g_e_n_t_._s_h

       This is the actual Pandora agent. This file is a shellscript that  col-
       lects   the   data  con ﬁgured  in  the  pandora_agent.conf  and  pan-
       dora_user.conf ﬁles. It also transfers the data packages to  the  Pan-
       dora server.

       _/_o_p_t_/_p_a_n_d_o_r_a___a_g_e_n_t_/_p_a_n_d_o_r_a___a_g_e_n_t___d_a_e_m_o_n

       Start  and  stop script. It makes a call to pandora_agent.sh. It offers
       two options, start and stop.

       _/_o_p_t_/_p_a_n_d_o_r_a___a_g_e_n_t_/_p_a_n_d_o_r_a_._l_o_g

       Textﬁfile where the activity of the Pandora agent is saved,  when  the
       agent is executed in debugging mode.

       KKeeyy ggeenneerraattiioonn

       The SSH keys generated must be:

         SSH version2 keys •
         Open SSH format keys •
         Dif ﬁeHellman  (DH)  format keys • To generate the keys the command
       ssh-keygen is executed followed by  the  specific  parameters  for  our
       operating system. Please, create key WITHOUT password.

       The  public  key must be copied into the /home/.pandora/authorized_keys
       ﬁfile in the Pandora server. Before starting the Pandora agent the SSH
       authentication  must  be checked. To do this the following command must
       be executed on the agent machine:

       _$ _s_s_h _p_a_n_d_o_r_a_@_p_a_n_d_o_r_a___s_e_r_v_e_r

       The system must  connect  successfully  BEFORE  launching  the  Pandora
       agent.

       FFiirrsstt rruunnnniinngg ooff tthhee UUnniixx aaggeenntt

       To start the agent it is only necessary to execute pandora_agent_daemon
       start  from  /opt/pandora_client.   Pandora  Agent  creates  a     ﬁle
       (/var/run/pandora.pid)  with  the  PID number of the process when it is
       started.

       For IPSO systems the agent will be started with a nice -10 priority, so
       it becomes the process with the lowest priority over the system CPU. It
       will be executed when no other processes with  a  higher  priority  are
       waiting in the system CPU queue.

       In BSD systems the maximum priority is +20 and the lowest -20.

       To   stop  agent,  execute  pandora_agent_daemon  stop  from  /opt/pan-
       dora_agent.

       AAddvvaanncceedd ccoonnﬁgguurraattiioonn ffoorr UUnniixx AAggeenntt

       The real power of Pandora resides in the capability of  the  agents  to
       run  user  deﬁned scripts. This could be used to collect specific data
       or to perform an operation to return any desired  value.  This  is  the
       purpose of pandora_user.conf.

       This  file  is  executed  every  in agent loop. It is a shell-script in
       which any command can be executed, as long as the output is in the  XML
       format  the  agent  uses  to send data to the server. The XML structure
       would be:

       _<_m_o_d_u_l_e_>
       _<_n_a_m_e_>_N_A_M_E_<_/_n_a_m_e_>
       _<_t_y_p_e_>_T_Y_P_E_<_/_t_y_p_e_>
       _<_d_a_t_a_>_D_A_T_A_<_/_d_a_t_a_>
       _<_/_m_o_d_u_l_e_>

       Where NAME, TYPE and DATA are the variables already deﬁned in previous
       sections.  The XML must be built manually, usually using echo commands.


EEXXAAMMPPLLEESS
       An example of a Unix module would be:

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _c_p_u___u_s_e_r
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _v_m_s_t_a_t _| _t_a_i_l _-_1 _| _a_w_k ’_{ _p_r_i_n_t _$_1_4 _}’
       _m_o_d_u_l_e___m_i_n _0
       _m_o_d_u_l_e___m_a_x _1_0_0
       _m_o_d_u_l_e___d_e_s_c_r_i_p_t_i_o_n _U_s_e_r _C_P_U
       _m_o_d_u_l_e___e_n_d

       This would be the script a customized agent would  use  for  Checkpoint
       FW1 in IPSO agents:

       _#_!_/_b_i_n_/_s_h
       _# _P_a_n_d_o_r_a _U_s_e_r_-_D_e_f_i_n_e_d _a_c_q_u_i_s_i_t_i_o_n _s_c_r_i_p_t
       _# _T_h_i_s _c_o_d_e _i_s _u_n_d_e_r _G_P_L _l_i_c_e_n_c_e
       _# _P_l_e_a_s_e _r_e_f_e_r _d_o_c_u_m_e_n_t_a_t_i_o_n _f_o_r _m_o_r_e _e_x_a_m_p_l_e _a_n_d _a _m_o_r_e
       _# _d_e_p_t_h _u_s_a_g_e _i_n_s_t_r_u_c_t_i_o_n_s
       _# _m_b_u_f _c_l_u_s_t_e_r_s _u_s_a_d_o_s _(_%_)
       _M_B_U_F___T_O_T_A_L_= ‘_n_e_t_s_t_a_t  _-_m _|_g_r_e_p _m_b_u_f _c_l_u_s_t_e_r _| _t_r _-_s _/   _|_a_w_k ’_{ _p_r_i_n_t
       _$_2 _}’‘
       _M_B_U_F___U_S_E_D_=‘_n_e_t_s_t_a_t _-_m _|_g_r_e_p _m_b_u_f _c_l_u_s_t_e_r _| _t_r _-_s _/   _|_a_w_k ’_{ _p_r_i_n_t _$_1
       _}’‘
       _M_B_U_F___U_S_E_D___P_E_R_= ‘_e_c_h_o _$_M_B_U_F___T_O_T_A_L _$_M_B_U_F___U_S_E_D _| _a_w_k ’_{ _p_r_i_n_t _$_2 _/ _(_$_1 _/
       _1_0_0_) _}
       _e_c_h_o _<_m_o_d_u_l_e_>
       _e_c_h_o _<_n_a_m_e_>_M_B_U_F___C_L_U_S_T_E_R___U_S_E_D___P_E_R_<_/_n_a_m_e_>
       _e_c_h_o _<_d_a_t_a_>_$_M_B_U_F___U_S_E_D___P_E_R_<_/_d_a_t_a_>
       _e_c_h_o _<_t_y_p_e_>_g_e_n_e_r_i_c___d_a_t_a_<_/_t_y_p_e_>
       _e_c_h_o _<_/_m_o_d_u_l_e_>

       A more complex example could be:

       _#_!_/_b_i_n_/_s_h
       _# _P_a_n_d_o_r_a _U_s_e_r_-_D_e_f_i_n_e_d _a_c_q_u_i_s_i_t_i_o_n _s_c_r_i_p_t
       _# _T_h_i_s _c_o_d_e _i_s _u_n_d_e_r _G_P_L _l_i_c_e_n_c_e
       _# _P_l_e_a_s_e _r_e_f_e_r _d_o_c_u_m_e_n_t_a_t_i_o_n _f_o_r _m_o_r_e _e_x_a_m_p_l_e _a_n_d _a _m_o_r_e
       _# _d_e_p_t_h _u_s_a_g_e _i_n_s_t_r_u_c_t_i_o_n_s
       _# _C_a_l_c_u_l_a_t_i_n_g _t_h_e _n_u_m_b_e_r _o_f _p_a_c_k_a_g_e_s _g_e_n_e_r_a_t_e_d _b_y _E_T_H_2_,
       _# _i_f _n_o_t_h_i_n_g _i_s _g_e_n_e_r_a_t_e_d
       _# _w_i_t_h_i_n _2_0 _s_e_c_o_n_d_s _a_n _a_l_e_r_t _i_s _r_o_s_e_n
       _# _P_e_r_f_o_r_m _t_h_e _c_a_l_c_u_l_a_t_i_o_n _b_e_t_w_e_e_n _8 _t_o _2_3_h_. _R_e_t_u_r_n _o_k _f_o_r _t_i_m_e_s
       _# _o_u_t_s_i_d_e _t_h_i_s _r_a_n_g_e
       _e_c_h_o _<_m_o_d_u_l_e_>
       _e_c_h_o _<_n_a_m_e_>_P_a_c_k_e_t___G_e_n_e_r_a_t_o_r___C_h_e_c_k_<_/_n_a_m_e_>
       _e_c_h_o _<_t_y_p_e_>_g_e_n_e_r_i_c___p_r_o_c_<_/_t_y_p_e_>
       _U_N_O_=‘_i_f_c_o_n_f_i_g _e_t_h_2 _| _g_r_e_p _T_X _p_a_c_k_e_t_s _| _c_u_t _-_f _2 _-_d  _:  _|  _g_r_e_p  _-_o  _-_e
       _[_0_-_9_]_* ‘
       _s_l_e_e_p _2_0
       _D_O_S_= ‘_i_f_c_o_n_f_i_g  _e_t_h_2  _|  _g_r_e_p  _T_X _p_a_c_k_e_t_s _| _c_u_t _-_f _2 _-_d _: _| _g_r_e_p _-_o _-_e
       _[_0_-_9_]_* ‘
       _H_O_R_A_=‘_d_a_t_e _+_%_k ‘
       _i_f _[ _$_H_O_R_A _-_l_t _8 _] _&_& _[ _$_H_O_R_A _-_g_t _1_1 _]
       _t_h_e_n
       _# _T_i_m_e _o_u_t _o_f _r_a_n_g_e_, _n_o _c_h_e_c_k_i_n_g_, _e_v_e_r_y_t_h_i_n_g _O_K
       _# _F_u_e_r_a _d_e _h_o_r_a_, _n_o _c_o_m_p_r_u_e_b_o_, _e_s_t_a _O_K
       _e_c_h_o _<_d_a_t_a_>_1_<_/_d_a_t_a_>
       _e_l_s_e
       _i_f _[ _$_U_N_O _=_= _$_D_O_S _]
       _t_h_e_n
       _e_c_h_o _<_d_a_t_a_>_0_<_/_d_a_t_a_>
       _e_l_s_e
       _e_c_h_o _<_d_a_t_a_>_1_<_/_d_a_t_a_>
       _f_i
       _f_i
       _e_c_h_o _<_/_m_o_d_u_l_e_>

       IImmpplleemmeennttaattiioonn eexxaammpplleess ffoorr UUnniixx AAggeennttss

       Example #1: calculate the number of HITS of the main page of an  Apache
       Web server:

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _W_E_B___H_i_t_s
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a___i_n_c
       _m_o_d_u_l_e___e_x_e_c _c_a_t _/_v_a_r_/_l_o_g_/_a_p_a_c_h_e_/_a_c_c_e_s_s_._l_o_g _| _g_r_e_p _i_n_d_e_x _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d

       Example:  check  if  the process of the DNS server (named) is active or
       fell over:

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _D_N_S___D_a_e_m_o_n
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___p_r_o_c
       _m_o_d_u_l_e___e_x_e_c _p_s _-_A_f _| _g_r_e_p _n_a_m_e_d _| _g_r_e_p _-_v _g_r_e_p _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d

       Complete example of the conﬁguration of an agent for Linux
             # General Parameters
             # ================== _s_e_r_v_e_r___i_p _1_9_2_._1_6_8_._1_0_0_._4_5
       _s_e_r_v_e_r___p_a_t_h _/_o_p_t_/_p_a_n_d_o_r_a_/_d_a_t_a___i_n
       _p_a_n_d_o_r_a___p_a_t_h _/_o_p_t_/_p_a_n_d_o_r_a___n_g_/
       _t_e_m_p_o_r_a_l _/_o_p_t_/_p_a_n_d_o_r_a___n_g_/_d_a_t_a___o_u_t
       _i_n_t_e_r_v_a_l _3_0_0
       _h_o_s_t_n_a_m_e _l_i_n_u_x_b_o_x_0_1
       _d_e_b_u_g _0
       _c_h_e_c_k_s_u_m _1

       # Module Definition # ================= _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _c_p_u___u_s_e_r
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _v_m_s_t_a_t _1 _2 _| _t_a_i_l _-_1 _| _a_w_k ’_{ _p_r_i_n_t _$_1_4 _}’
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _c_p_u___s_y_s
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _v_m_s_t_a_t _1 _2 _| _t_a_i_l _-_1 _| _a_w_k ’_{ _p_r_i_n_t _$_1_4 _}’
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _d_i_s_k___r_o_o_t___f_r_e_e
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _d_f _-_k_h _/ _| _t_a_i_l _-_1 _| _a_w_k ’_{ _p_r_i_n_t _1_0_0 _- _$_5 _}’
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _d_i_s_k___s_t_o_r_e___f_r_e_e
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _d_f _-_k_h _/_s_t_o_r_e _| _t_a_i_l _-_1 _| _a_w_k ’_{ _p_r_i_n_t _1_0_0 _- _$_5 _}’
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _m_e_m_f_r_e_e
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _c_a_t _/_p_r_o_c_/_m_e_m_i_n_f_o _| _g_r_e_p _M_e_m_F_r_e_e _| _c_u_t _-_c _1_0_-_2_3
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _m_e_m_u_s_e_d
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _c_a_t _/_p_r_o_c_/_m_e_m_i_n_f_o _| _g_r_e_p _A_c_t_i_v_e _| _c_u_t _-_c _8_- _| _c_u_t _-_f _1 _-_d _k
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _p_r_o_c_t_o_t_a_l
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a
       _m_o_d_u_l_e___e_x_e_c _p_s _-_A _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _s_s_h_d
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___p_r_o_c
       _m_o_d_u_l_e___e_x_e_c _p_s _-_A_f _| _g_r_e_p _s_s_h_d _| _g_r_e_p _-_v _g_r_e_p _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _W_E_B___H_i_t_s
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a___i_n_c _m_o_d_u_l_e___e_x_e_c _c_a_t _/_v_a_r_/_l_o_g_/_a_p_a_c_h_e_/_a_c_c_e_s_s_._l_o_g
       _| _g_r_e_p _i_n_d_e_x_._p_h_p _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _e_M_a_i_l_s___p_r_o_c
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a___i_n_c
       _m_o_d_u_l_e___e_x_e_c _c_a_t _/_v_a_r_/_l_o_g_/_m_a_i_l_/_m_a_i_l_._l_o_g _| _g_r_e_p _m_e_s_s_a_g_e_-_i_d _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _F_T_P___s_e_s_s_i_o_n_s
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a___i_n_c
       _m_o_d_u_l_e___e_x_e_c _c_a_t _/_v_a_r_/_l_o_g_/_s_y_s_l_o_g _| _g_r_e_p _F_T_P _s_e_s_s_i_o_n _o_p_e_n_e_d _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d

       _m_o_d_u_l_e___b_e_g_i_n
       _m_o_d_u_l_e___n_a_m_e _e_M_a_i_l_s___S_P_A_M
       _m_o_d_u_l_e___t_y_p_e _g_e_n_e_r_i_c___d_a_t_a___i_n_c
       _m_o_d_u_l_e___e_x_e_c _c_a_t _/_v_a_r_/_l_o_g_/_m_a_i_l_/_m_a_i_l_._l_o_g _| _g_r_e_p _i_d_e_n_t_i_f_i_e_d _s_p_a_m _| _w_c _-_l
       _m_o_d_u_l_e___e_n_d


AAUUTTHHOORR
       Pandora Free Monitoring System is made and copyrighted by Sancho Lerena
       <sancho.lerena@artica.es>  Pandora  is  a  project initiated and mainly
       developed by Sancho Lerena, at present other people is working  on  it:
       Raul  Mateos, David Villanueva, Esteban Sanchez, Jose Navarro, Jonathan
       Barajas and Manuel Arostegui We want to thank  many  other  people  who
       help  us with translation, graphic design, bugs reporting and interest-
       ing ideas.



SSEEEE AALLSSOO
       ppaannddoorraa
       ppaannddoorraa__sseerrvveerr
       ppaannddoorraa__aaggeennttss
       ppaannddoorraa__ccoonnssoollee





                                                               Pandora(Agents)
